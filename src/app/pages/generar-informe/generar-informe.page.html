<ion-header>
  <ion-toolbar class="toolbar-header">
    <ion-title class="title-text">Informe de Veh√≠culo</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content class="content-background">
  <!-- Formulario de consulta actualizado -->
  <ion-card class="query-card">
    <ion-card-header class="card-header">
      <ion-card-title class="card-title">üîç Consultar Datos</ion-card-title>
    </ion-card-header>
    <ion-card-content class="card-content">
      <!-- Campo Patente (existente) -->
      <ion-item class="input-item">
        <ion-input 
          class="custom-input"
          label="Patente del veh√≠culo" 
          label-placement="stacked"
          [(ngModel)]="patente"
          placeholder="Ej: AB123CD"
          maxlength="8"
          (ionChange)="formatearPatente()"
          required
        ></ion-input>
      </ion-item>

      <!-- Campo Fecha (existente) -->
      <ion-item class="input-item">
        <ion-datetime
          class="custom-input"
          label="Mes de consulta"
          label-placement="stacked"
          [(ngModel)]="mesConsulta"
          display-format="MMM YYYY"
          month-short-names="ene, feb, mar, abr, may, jun, jul, ago, sep, oct, nov, dic"
          placeholder="Seleccione mes"
          required
        ></ion-datetime>
      </ion-item>

      <!-- ===== NUEVOS CAMPOS ===== -->
      <!-- Combustible -->
      <ion-item class="input-item">
        <ion-input
          class="custom-input"
          type="number"
          label="Combustible consumido (L)"
          label-placement="stacked"
          [(ngModel)]="combustibleConsumido"
          placeholder="Ej: 120"
          min="0"
          required
        ></ion-input>
      </ion-item>

      <!-- Ganancias -->
      <ion-item class="input-item">
        <ion-input
          class="custom-input"
          type="number"
          label="Ganancias ($)"
          label-placement="stacked"
          [(ngModel)]="ganancias"
          placeholder="Ej: 2500000"
          min="0"
          required
        ></ion-input>
      </ion-item>

      <!-- Kilometraje -->
      <ion-item class="input-item">
        <ion-input
          class="custom-input"
          type="number"
          label="Kilometraje (km)"
          label-placement="stacked"
          [(ngModel)]="kilometraje"
          placeholder="Ej: 1500"
          min="0"
          required
        ></ion-input>
      </ion-item>
      <!-- ===== FIN NUEVOS CAMPOS ===== -->

      <!-- Bot√≥n Buscar (existente) -->
      <ion-button 
        expand="block" 
        class="query-button"
        (click)="consultarDatosVehiculo()"
        [disabled]="!patente || !mesConsulta || !combustibleConsumido || !ganancias || !kilometraje"
      >
        <ion-icon name="search" slot="start"></ion-icon>
        Buscar Datos
      </ion-button>
    </ion-card-content>
  </ion-card>

  <!-- Secci√≥n Informe (existente) -->
  <div *ngIf="datosConsultados" class="report-section">
    <ion-card class="report-card">
      <ion-card-content>
        <div *ngIf="!informeGenerado" class="pre-report">
          <ion-icon name="document-text-outline" class="pre-icon"></ion-icon>
          <p>Datos listos para generar el informe</p>
        </div>
        
        <div *ngIf="informeGenerado" [innerHTML]="informeHTML" class="generated-report"></div>
      </ion-card-content>
    </ion-card>

    <ion-button 
      expand="block" 
      color="success" 
      class="generate-btn"
      (click)="generarInforme()"
      [disabled]="!datosDisponibles">
      <ion-icon name="document-attach-outline" slot="start"></ion-icon>
      Generar Informe
    </ion-button>
  </div>
</ion-content>